{
  "consumer": "alerts",
  "tags": [
    "apm",
    "anomaly",
    "custom",
    "app_team"
  ],
  "name": "APM Service Anomaly",
  "enabled": true,
  "throttle": null,
  "schedule": {
    "interval": "1m"
  },
  "params": {
    "windowSize": 30,
    "windowUnit": "m",
    "anomalySeverityType": "critical",
    "environment": "<environment>"
  },
  "rule_type_id": "apm.anomaly",
  "notify_when": "onActionGroupChange",
  "actions": [
    {
      "group": "threshold_met",
      "id": "elastic-cloud-email",
      "params": {
        "message": "{{alertName}} alert is firing because of the following conditions:\n - Service name: {{context.serviceName}}\n - Type: {{context.transactionType}}\n - Environment: {{context.environment}}\n - Severity threshold: {{context.threshold}}\n - Severity value: {{context.triggerValue}}\nCheck service status in APM dashboard: https://5cde49de6d934a2680f1997dd58236ce.privatelink.westeurope.azure.elastic-cloud.com/app/apm/services?comparisonEnabled=true&environment=ENVIRONMENT_ALL&rangeFrom=now-1h&rangeTo=now&offset=1d",
    "to": [
      "<support-email-address>"
    ],
    "subject": "{{alertName}} was triggered"
    }
  },
    {
      "group": "recovered",
      "id": "elastic-cloud-email",
      "params": {
        "message": "Recovered\nCheck service status in APM dashboard: https://5cde49de6d934a2680f1997dd58236ce.privatelink.westeurope.azure.elastic-cloud.com/app/apm/services?comparisonEnabled=true&environment=ENVIRONMENT_ALL&rangeFrom=now-1h&rangeTo=now&offset=1d",
        "to": [
          "<support-email-address>"
        ],
        "subject": "{{alertName}} recovered"
      }
    }
  ]
}