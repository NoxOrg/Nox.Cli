# NOX Test Add user to AAD group

name: Test Add user to AAD group
cli:
  branch: test
  command: add-user-to-group
  command-alias: aadagu
  description: Test Add user to AAD group
  examples:
    - ["sync add-user-to-group", "--path <designFolder>"]
    - ["sync aadagu", "--path <designFolder>"]

jobs:
  sync-test:  
    steps:
      - name: Connect to AAD
        id: connect
        uses: azuread/connect_v1
        with:
          tenant-id: ${{ server.secrets.AZURE_TENANT_ID }}
          client-id: ${{ server.secrets.AZURE_CLIENT_ID }}
          client-secret: ${{ server.secrets.AZURE_CLIENT_SECRET }}
        display:
          success: Connected to Azure AD
          error: Failed to connect to Azure AD ${{ steps.connect.error-message }}
        run-at-server: true

      - name: Add user to group
        id: add-user
        uses: azuread/add-user-to-group@v1
        with:
          aad-client: ${{ steps.connect.outputs.aad-client }}
          group-id: 589d9526-5d3b-4180-b185-d5b1ff2dc4e6
          user-object-id: 6ff73a3a-fd56-42e9-aa23-9a14d89e12ee
        display:
          success: Added user to group
          error: Unable to add user to group (${{ steps.add-user.error-message }})
        run-at-server: true